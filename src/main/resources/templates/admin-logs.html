<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="fragments :: header"></head>
<body>
<nav th:replace="fragments :: navbar"></nav>

<div class="container mt-4">
    <h2 class="mb-3">Admin Logs</h2>

    <form class="row g-3 mb-4" method="get" th:action="@{/admin/logs}">
        <div class="col-md-3">
            <label class="form-label">Username</label>
            <input class="form-control" type="text" name="username" th:value="${fUsername}">
        </div>
        <div class="col-md-3">
            <label class="form-label">Action</label>
            <input class="form-control" type="text" name="action" th:value="${fAction}">
        </div>
        <div class="col-md-3">
            <label class="form-label">From</label>
            <input class="form-control" type="datetime-local" name="from" th:value="${fFrom}">
        </div>
        <div class="col-md-3">
            <label class="form-label">To</label>
            <input class="form-control" type="datetime-local" name="to" th:value="${fTo}">
        </div>
        <div class="col-12">
            <button class="btn btn-primary">Filter</button>
            <a class="btn btn-outline-secondary ms-2" th:href="@{/admin/logs}">Clear</a>
        </div>
    </form>

    <div class="row">
        <div class="col-lg-6 mb-4">
            <div class="card">
                <div class="card-header bg-light">
                    <strong>Audit DB Logs</strong>
                </div>
                <div class="card-body p-0">
                    <div th:if="${#lists.isEmpty(dbLogs)}" class="p-3 text-muted">No audit entries.</div>
                    <div class="table-responsive" th:if="${!#lists.isEmpty(dbLogs)}">
                        <table class="table table-sm table-striped mb-0">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>User</th>
                                    <th>Action</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="a : ${dbLogs}">
                                    <td th:text="${#temporals.format(a.timestamp, 'yyyy-MM-dd HH:mm:ss')}">time</td>
                                    <td th:text="${a.username}">user</td>
                                    <td th:text="${a.action}">action</td>
                                    <td th:text="${a.details}">details</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-6 mb-4">
            <div class="card">
                <div class="card-header bg-light">
                    <strong>Application Log (last 200 lines)</strong>
                </div>
                <div class="card-body">
                    <pre class="mb-0" style="white-space: pre-wrap; font-size: 0.85rem;"
                        th:text="${#strings.arrayJoin(fileLogs, '\n')}">logs...</pre>
                </div>
            </div>
        </div>
    </div>
</div>

<footer th:replace="fragments :: footer"></footer>
</body>
</html>